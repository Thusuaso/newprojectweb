{"ast":null,"code":"import { mapGetters } from \"vuex\";\nimport LocalService from \"@/service/LocalService\";\nimport socket from \"@/service/SocketService\";\nimport service from \"@/service/FinansService\";\nexport default {\n  data() {\n    return {\n      is_form: false,\n      date: new Date(),\n      is_kaydet: false,\n      is_sil: true,\n      is_degistir: true,\n      select_list: null,\n      is_loading: false,\n      yil: \"\",\n      ay: \"\",\n      gun: \"\"\n    };\n  },\n  localService: null,\n  created() {\n    this.localService = new LocalService();\n  },\n  computed: {\n    ...mapGetters([\"thmusteri_list_toplam_masraf\", \"thmusteri_list_toplam_tutar\", \"thmusteri_list\", \"thmusteri\"])\n  },\n  methods: {\n    formatPrice(value) {\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\n      return \"$\" + val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    },\n    tahsilat_secim(event) {\n      this.select_list = event.data;\n      this.date = this.localService.getStringDate(event.data.tarih);\n      this.$store.dispatch(\"tahsilatSecimAct\", event.data);\n      this.is_kaydet = true;\n      this.is_degistir = false;\n      this.is_sil = false;\n    },\n    kurSecim() {\n      const d = this.date;\n      const year = d.getFullYear(); // 2021\n      const mount = d.getMonth();\n      const day = d.getDate();\n      service.getGuncelKur(year, mount + 1, day).then(data => {\n        this.thmusteri.kur = data.result;\n      });\n    },\n    default_data() {\n      service.getMusteriTahsilatListe(this.thmusteri.musteri_id, this.thmusteri.siparisno).then(data => {\n        this.$store.dispatch(\"tahsilatLoadAct\", data);\n        this.is_loading = false;\n        this.is_form = false;\n        this.date = new Date();\n        this.is_kaydet = false;\n        this.is_sil = true;\n        this.is_degistir = true;\n      });\n    },\n    kaydet_click() {\n      if (!this.date) {\n        alert(\"Tarih Seçiniz..\");\n        return;\n      }\n      this.is_loading = true;\n      const data = this.thmusteri;\n      data.tarih = this.localService.getDateString(this.date);\n\n      // const users = JSON.parse(localStorage.getItem(\"user\"));\n      const users = this.$store.getters.__getUsername;\n      data.kullaniciadi = users;\n      service.tahsilatKaydetme(data).then(res => {\n        if (res.status) {\n          socket.siparis.emit(\"tahsilat_kayitdegisim_event\", data.siparisno);\n          socket.siparis.emit(\"anaSayfaDegisiklikEvent\", res.anaSayfaDegisiklikList);\n          this.default_data();\n        }\n      });\n    },\n    degistir_click() {\n      if (!this.date) {\n        alert(\"Tarih Seçiniz..\");\n        return;\n      }\n      const data = this.thmusteri;\n      data.tarih = this.localService.getDateString(this.date);\n\n      // const users = JSON.parse(localStorage.getItem(\"user\"));\n      const users = this.$store.getters.__getUsername;\n      data.kullaniciadi = users;\n      service.tahsilatGuncelleme(data).then(res => {\n        if (res.status) {\n          socket.siparis.emit(\"tahsilat_kayitdegisim_event\", data.siparisno);\n          socket.siparis.emit(\"anaSayfaDegisiklikEvent\", res.anaSayfaDegisiklikList);\n          this.default_data();\n        }\n      });\n    },\n    sil_click() {\n      if (!this.date) {\n        alert(\"Tarih Seçiniz..\");\n        return;\n      }\n      const id = this.thmusteri.id;\n      service.tahsilatSilme(id).then(res => {\n        if (res) {\n          socket.siparis.emit(\"tahsilat_kayitdegisim_event\", this.thmusteri.siparisno);\n          this.default_data();\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["mapGetters","LocalService","socket","service","data","is_form","date","Date","is_kaydet","is_sil","is_degistir","select_list","is_loading","yil","ay","gun","localService","created","computed","methods","formatPrice","value","val","toFixed","replace","toString","tahsilat_secim","event","getStringDate","tarih","$store","dispatch","kurSecim","d","year","getFullYear","mount","getMonth","day","getDate","getGuncelKur","then","thmusteri","kur","result","default_data","getMusteriTahsilatListe","musteri_id","siparisno","kaydet_click","alert","getDateString","users","getters","__getUsername","kullaniciadi","tahsilatKaydetme","res","status","siparis","emit","anaSayfaDegisiklikList","degistir_click","tahsilatGuncelleme","sil_click","id","tahsilatSilme"],"sourceRoot":"","sources":["C:\\PROJELER\\NewProjects\\gitPull\\newprojectweb\\src\\components\\finans\\Tahsilat.vue"],"sourcesContent":["<template>\r\n  <section>\r\n    <div class=\"columns\">\r\n      <div class=\"column is-6\">\r\n        <div class=\"columns is-multiline\">\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"musteriadi\"\r\n                type=\"text\"\r\n                :disabled=\"true\"\r\n                v-model=\"thmusteri.musteriadi\"\r\n              />\r\n              <label for=\"musteriadi\">Müşteri Adı</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"siparisno\"\r\n                type=\"text\"\r\n                :disabled=\"true\"\r\n                v-model=\"thmusteri.siparisno\"\r\n              />\r\n              <label for=\"siparisno\">Sipariş No</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <Calendar\r\n                @change=\"kurSecim\"\r\n                id=\"date\"\r\n                type=\"text\"\r\n                :disabled=\"is_form\"\r\n                v-model=\"date\"\r\n              />\r\n              <label for=\"date\">Tarih</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"bakiye\"\r\n                type=\"text\"\r\n                :disabled=\"true\"\r\n                v-model=\"thmusteri.bakiye\"\r\n              />\r\n              <label for=\"bakiye\">Bakiye</label>\r\n            </span>\r\n          </div>\r\n\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"bakiye\"\r\n                type=\"text\"\r\n                :disabled=\"is_form\"\r\n                v-model=\"thmusteri.tutar\"\r\n              />\r\n              <label for=\"bakiye\">Bakiye</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"masraf\"\r\n                type=\"text\"\r\n                :disabled=\"is_form\"\r\n                v-model=\"thmusteri.masraf\"\r\n              />\r\n              <label for=\"masraf\">Masraf</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"kur\"\r\n                type=\"text\"\r\n                :disabled=\"is_form\"\r\n                v-model=\"thmusteri.kur\"\r\n              />\r\n              <label for=\"kur\">Kur</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-12\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"not\"\r\n                type=\"text\"\r\n                :disabled=\"is_form\"\r\n                v-model=\"thmusteri.aciklama\"\r\n              />\r\n              <label for=\"not\">Not</label>\r\n            </span>\r\n          </div>\r\n\r\n          <div class=\"column is-4\">\r\n            <Button\r\n              :disabled=\"is_kaydet\"\r\n              class=\"p-button-success\"\r\n              @click=\"kaydet_click\"\r\n              label=\"Kaydet\"\r\n            />\r\n          </div>\r\n          <div class=\"column is-4\">\r\n            <Button\r\n              :disabled=\"is_degistir\"\r\n              @click=\"degistir_click\"\r\n              class=\"p-button-info\"\r\n              label=\"Değiştir\"\r\n            />\r\n          </div>\r\n          <div class=\"column is-4\">\r\n            <Button\r\n              :disabled=\"is_sil\"\r\n              class=\"p-button-danger\"\r\n              label=\"Sil\"\r\n              @click=\"sil_click\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"column is-6\">\r\n        <DataTable\r\n          :value=\"thmusteri_list\"\r\n          selectionMode=\"single\"\r\n          :selection=\"select_list\"\r\n          @row-select=\"tahsilat_secim($event)\"\r\n          :scrollable=\"true\"\r\n          scrollHeight=\"600px\"\r\n        >\r\n          <Column field=\"tarih\" header=\"Tarih\" bodyStyle=\"text-align:center;\">\r\n            <template #body=\"slotProps\">\r\n              {{ slotProps.data.tarih }}\r\n            </template>\r\n          </Column>\r\n          <Column\r\n            field=\"siparisno\"\r\n            header=\"Sipariş No\"\r\n            bodyStyle=\"text-align:center;\"\r\n          >\r\n            <template #body=\"slotProps\">\r\n              {{ slotProps.data.siparisno }}\r\n            </template>\r\n          </Column>\r\n          <Column field=\"tutar\" header=\"Tutar\" bodyStyle=\"text-align:center;\">\r\n            <template #body=\"slotProps\">\r\n              {{ formatPrice(slotProps.data.tutar) }}\r\n            </template>\r\n            <template #footer>\r\n              {{ formatPrice(thmusteri_list_toplam_tutar) }}\r\n            </template>\r\n          </Column>\r\n          <Column field=\"masraf\" header=\"Masraf\" bodyStyle=\"text-align:center;\">\r\n            <template #body=\"slotProps\">\r\n              {{ formatPrice(slotProps.data.masraf) }}\r\n            </template>\r\n            <template #footer>\r\n              {{ formatPrice(thmusteri_list_toplam_masraf) }}\r\n            </template>\r\n          </Column>\r\n          <Column field=\"kur\" header=\"Kur\" bodyStyle=\"text-align:center;\">\r\n            <template #body=\"slotProps\">\r\n              {{ slotProps.data.kur }}\r\n            </template>\r\n          </Column>\r\n        </DataTable>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport LocalService from \"@/service/LocalService\";\r\nimport socket from \"@/service/SocketService\";\r\nimport service from \"@/service/FinansService\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      is_form: false,\r\n      date: new Date(),\r\n      is_kaydet: false,\r\n      is_sil: true,\r\n      is_degistir: true,\r\n      select_list: null,\r\n      is_loading: false,\r\n      yil: \"\",\r\n      ay: \"\",\r\n      gun: \"\",\r\n    };\r\n  },\r\n  localService: null,\r\n\r\n  created() {\r\n    this.localService = new LocalService();\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      \"thmusteri_list_toplam_masraf\",\r\n      \"thmusteri_list_toplam_tutar\",\r\n      \"thmusteri_list\",\r\n      \"thmusteri\",\r\n    ]),\r\n  },\r\n  methods: {\r\n    formatPrice(value) {\r\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\r\n      return \"$\" + val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\r\n    },\r\n    tahsilat_secim(event) {\r\n      this.select_list = event.data;\r\n\r\n      this.date = this.localService.getStringDate(event.data.tarih);\r\n\r\n      this.$store.dispatch(\"tahsilatSecimAct\", event.data);\r\n      this.is_kaydet = true;\r\n      this.is_degistir = false;\r\n      this.is_sil = false;\r\n    },\r\n    kurSecim() {\r\n      const d = this.date;\r\n\r\n      const year = d.getFullYear(); // 2021\r\n      const mount = d.getMonth();\r\n      const day = d.getDate();\r\n\r\n      service.getGuncelKur(year, mount + 1, day).then((data) => {\r\n        this.thmusteri.kur = data.result;\r\n      });\r\n    },\r\n    default_data() {\r\n      service\r\n        .getMusteriTahsilatListe(\r\n          this.thmusteri.musteri_id,\r\n          this.thmusteri.siparisno\r\n        )\r\n        .then((data) => {\r\n          this.$store.dispatch(\"tahsilatLoadAct\", data);\r\n          this.is_loading = false;\r\n          this.is_form = false;\r\n          this.date = new Date();\r\n          this.is_kaydet = false;\r\n          this.is_sil = true;\r\n          this.is_degistir = true;\r\n        });\r\n    },\r\n    kaydet_click() {\r\n      if (!this.date) {\r\n        alert(\"Tarih Seçiniz..\");\r\n        return;\r\n      }\r\n\r\n      this.is_loading = true;\r\n      const data = this.thmusteri;\r\n\r\n      data.tarih = this.localService.getDateString(this.date);\r\n\r\n      // const users = JSON.parse(localStorage.getItem(\"user\"));\r\n      const users = this.$store.getters.__getUsername;\r\n\r\n      data.kullaniciadi = users;\r\n\r\n      service.tahsilatKaydetme(data).then((res) => {\r\n        if (res.status) {\r\n          socket.siparis.emit(\"tahsilat_kayitdegisim_event\", data.siparisno);\r\n          socket.siparis.emit(\r\n            \"anaSayfaDegisiklikEvent\",\r\n            res.anaSayfaDegisiklikList\r\n          );\r\n          this.default_data();\r\n        }\r\n      });\r\n    },\r\n    degistir_click() {\r\n      if (!this.date) {\r\n        alert(\"Tarih Seçiniz..\");\r\n        return;\r\n      }\r\n      const data = this.thmusteri;\r\n\r\n      data.tarih = this.localService.getDateString(this.date);\r\n\r\n      // const users = JSON.parse(localStorage.getItem(\"user\"));\r\n      const users = this.$store.getters.__getUsername;\r\n\r\n      data.kullaniciadi = users;\r\n\r\n      service.tahsilatGuncelleme(data).then((res) => {\r\n        if (res.status) {\r\n          socket.siparis.emit(\"tahsilat_kayitdegisim_event\", data.siparisno);\r\n          socket.siparis.emit(\r\n            \"anaSayfaDegisiklikEvent\",\r\n            res.anaSayfaDegisiklikList\r\n          );\r\n          this.default_data();\r\n        }\r\n      });\r\n    },\r\n    sil_click() {\r\n      if (!this.date) {\r\n        alert(\"Tarih Seçiniz..\");\r\n        return;\r\n      }\r\n      const id = this.thmusteri.id;\r\n\r\n      service.tahsilatSilme(id).then((res) => {\r\n        if (res) {\r\n          socket.siparis.emit(\r\n            \"tahsilat_kayitdegisim_event\",\r\n            this.thmusteri.siparisno\r\n          );\r\n          this.default_data();\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.input-style {\r\n  text-align: center;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}