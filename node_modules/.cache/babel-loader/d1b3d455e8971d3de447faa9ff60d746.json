{"ast":null,"code":"import { mapGetters } from \"vuex\";\nimport service from \"@/service/MusteriIslemService\";\nimport socket from \"@/service/SocketService\";\nimport MusteriSiparisDetay from \"./MusteriSiparisDetay\";\nimport { useVuelidate } from \"@vuelidate/core\";\nimport { required } from \"@vuelidate/validators\";\nexport default {\n  setup: () => ({\n    v$: useVuelidate()\n  }),\n  validations() {\n    return {\n      select_ulke: {\n        required\n      },\n      select_temsilci: {\n        required\n      },\n      select_satisci: {\n        required\n      },\n      selectOncelik: {\n        required\n      },\n      musteri_model: {\n        musteri_adi: {\n          required\n        },\n        unvan: {\n          required\n        },\n        mail_adresi: {\n          required\n        },\n        sira: {\n          required\n        },\n        adres: {\n          required\n        },\n        marketing: {\n          required\n        },\n        telefon: {\n          required\n        }\n      }\n    };\n  },\n  data() {\n    return {\n      submitted: false,\n      select_ulke: null,\n      is_form: false,\n      filter_ulke_list: null,\n      select_temsilci: null,\n      select_satisci: null,\n      filter_temsilci_list: null,\n      filter_satisci_list: null,\n      is_kaydet: false,\n      selectYil: null,\n      siparis_ozet_list: null,\n      selectOncelik: null,\n      is_sil: true,\n      oncelikList: [{\n        id: 1,\n        name: \"A\"\n      }, {\n        id: 2,\n        name: \"B\"\n      }, {\n        id: 3,\n        name: \"C\"\n      }]\n    };\n  },\n  components: {\n    MusteriSiparisDetay\n  },\n  created() {\n    if (!this.is_yeni) {\n      this.select_ulke = this.musteri_ulke_list.find(x => x.id == this.musteri_model.ulke_id);\n      this.select_temsilci = this.musteri_temsilci_list.find(x => x.id == this.musteri_model.musteri_temsilci_id);\n      this.select_satisci = this.musteri_temsilci_list.find(x => x.id == this.musteri_model.satisci).kullanici_adi;\n      this.siparis_ozet_list = this.siparis_ozet;\n      this.selectOncelik = this.oncelikList.find(x => x.name == this.musteri_model.selectOncelik);\n      this.is_sil = false;\n    }\n  },\n  computed: {\n    ...mapGetters([\"musteri_model\", \"siparis_ozet\", \"siparis_ozet_ayrinti\", \"musteri_ulke_list\", \"musteri_temsilci_list\"])\n  },\n  props: [\"is_yeni\"],\n  methods: {\n    isFollowChange() {\n      service.setCustomerChangeFollow(this.musteri_model.musteri_adi, this.musteri_model.takip).then(data => {\n        if (data) {\n          this.$toast.add({\n            severity: \"success\",\n            summary: \"Takip\",\n            detail: \"Takip Başarıyla Değişti\",\n            life: 3000\n          });\n          this.emitter.emit(\"followingStatus\", false);\n        } else {\n          this.$toast.add({\n            severity: \"warning\",\n            summary: \"Takip\",\n            detail: \"Takip Değiştirme Hatalı\",\n            life: 3000\n          });\n        }\n      });\n    },\n    YilUrunSecim(event) {\n      if (event.data) {\n        this.selectYil = event.data;\n        service.getMusteriSiparisDetay(event.data.Yil, event.data.id).then(data => {\n          this.$store.dispatch(\"siparis_ozet_ayrinti_act\", data.siparis_detay);\n          this.is_form = true;\n        });\n      }\n    },\n    formatPrice(value) {\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\n      return \"$\" + val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    },\n    ulke_complete_event(event) {\n      this.filter_ulke_list = this.musteri_ulke_list.filter(x => {\n        return x.ulke_adi.toString().toLowerCase().indexOf(event.query.toString().toLowerCase()) >= 0;\n      });\n    },\n    temsilci_complete_event(event) {\n      this.filter_temsilci_list = this.musteri_temsilci_list.filter(x => {\n        return x.kullanici_adi.toString().toLowerCase().indexOf(event.query.toString().toLowerCase()) >= 0;\n      });\n    },\n    satisci_complete_event(event) {\n      this.filter_satisci_list = this.musteri_temsilci_list.filter(x => {\n        return x.kullanici_adi.toString().toLowerCase().indexOf(event.query.toString().toLowerCase()) >= 0;\n      });\n      this.musteri_model.satisci = this.filter_satisci_list[0].id;\n    },\n    musteri_kaydet_click() {\n      this.submitted = true;\n      if (this.v$.$invalid) {\n        this.$toast.add({\n          severity: \"error\",\n          summary: \"Zorunlu Alanlar\",\n          detail: \"Zorunlu alanları doldurunuz!\",\n          life: 3000\n        });\n      } else {\n        if (this.musteri_model.musteri_adi.length <= 0) {\n          this.$toast.add({\n            severity: \"error\",\n            summary: \"Müşteri Kaydet\",\n            detail: \"Müşteri Adı Giriniz..\",\n            life: 3000\n          });\n          return;\n        }\n        if (this.musteri_model.marketing.length <= 0) {\n          this.$toast.add({\n            severity: \"error\",\n            summary: \"Müşteri Kaydet\",\n            detail: \"Marketing Giriniz..\",\n            life: 3000\n          });\n          return;\n        }\n        if (this.select_ulke == null) {\n          this.$toast.add({\n            severity: \"error\",\n            summary: \"Müşteri Kaydet\",\n            detail: \"Ülke Giriniz..\",\n            life: 3000\n          });\n          return;\n        }\n        if (this.select_temsilci == null) {\n          this.$toast.add({\n            severity: \"error\",\n            summary: \"Müşteri Kaydet\",\n            detail: \"Temsilci Seçiniz..\",\n            life: 3000\n          });\n          return;\n        }\n        this.musteri_model.musteri_temsilci_id = this.select_temsilci.id;\n        this.musteri_model.ulke_id = this.select_ulke.id;\n        let kullaniciadi = JSON.parse(localStorage.getItem(\"user\")).kullaniciAdi;\n        this.musteri_model.kullanici_id = this.musteri_temsilci_list.find(x => x.kullanici_adi === kullaniciadi).id;\n        this.musteri_model.selectOncelik = this.selectOncelik.name;\n        if (this.is_yeni) this.musteri_kayit_islemi();else this.musteri_gunceleme_islemi();\n      }\n    },\n    musteri_gunceleme_islemi() {\n      if (this.musteri_model.id == null) {\n        alert(\"kayıt değiştirilemez.\");\n        return;\n      }\n      this.is_kaydet = true;\n      service.musteriGuncelle(this.musteri_model).then(response => {\n        if (response.status) {\n          this.$toast.add({\n            severity: \"success\",\n            summary: \"Müşteri Güncelleme\",\n            detail: \"Müşteri Başarıyla Güncellendi\",\n            life: 3000\n          });\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\n        } else {\n          this.$toast.add({\n            severity: \"error\",\n            summary: \"Müşteri Güncelleme\",\n            detail: \"Müşteri Başarısız\",\n            life: 3000\n          });\n          this.is_kaydet = false;\n        }\n      });\n    },\n    musteri_kayit_islemi() {\n      const data = {\n        ...this.musteri_model\n      };\n      this.is_kaydet = true;\n      service.musteriKaydet(data).then(response => {\n        if (response.status) {\n          alert(\"Musteri kaydı yapıldı.\");\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\n        } else {\n          alert(\"Müşteri kaydı yapılamadı kontrol ediniz.\");\n          this.is_kaydet = false;\n        }\n      });\n    },\n    musteri_sil_click() {\n      this.is_sil = true;\n      service.musteriSilme(this.musteri_model.id).then(response => {\n        if (response.status) {\n          alert(\"Müşteri Kaydı Silindi.\");\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\n        } else {\n          alert(\"Müşteri kaydı silinemedi kontrol ediniz.\");\n          this.is_sil = false;\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["mapGetters","service","socket","MusteriSiparisDetay","useVuelidate","required","setup","v$","validations","select_ulke","select_temsilci","select_satisci","selectOncelik","musteri_model","musteri_adi","unvan","mail_adresi","sira","adres","marketing","telefon","data","submitted","is_form","filter_ulke_list","filter_temsilci_list","filter_satisci_list","is_kaydet","selectYil","siparis_ozet_list","is_sil","oncelikList","id","name","components","created","is_yeni","musteri_ulke_list","find","x","ulke_id","musteri_temsilci_list","musteri_temsilci_id","satisci","kullanici_adi","siparis_ozet","computed","props","methods","isFollowChange","setCustomerChangeFollow","takip","then","$toast","add","severity","summary","detail","life","emitter","emit","YilUrunSecim","event","getMusteriSiparisDetay","Yil","$store","dispatch","siparis_detay","formatPrice","value","val","toFixed","replace","toString","ulke_complete_event","filter","ulke_adi","toLowerCase","indexOf","query","temsilci_complete_event","satisci_complete_event","musteri_kaydet_click","$invalid","length","kullaniciadi","JSON","parse","localStorage","getItem","kullaniciAdi","kullanici_id","musteri_kayit_islemi","musteri_gunceleme_islemi","alert","musteriGuncelle","response","status","siparis","musteriKaydet","musteri_sil_click","musteriSilme"],"sourceRoot":"","sources":["C:\\PROJELER\\NewProjects\\gitPull\\newprojectweb\\src\\components\\musteriler\\MusteriDetay.vue"],"sourcesContent":["<template>\r\n  <section>\r\n    <div class=\"columns\">\r\n      <div class=\"column is-9\">\r\n        <div class=\"columns\">\r\n          <div class=\"column is-12\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"musteriAdi\"\r\n                type=\"text\"\r\n                v-model=\"musteri_model.musteri_adi\"\r\n                :class=\"{\r\n                  'p-invalid':\r\n                    v$.musteri_model.musteri_adi.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"musteriAdi\">Müşteri Adı</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column\">\r\n            <span class=\"p-float-label\">\r\n              <Textarea\r\n                id=\"firmaAdi\"\r\n                type=\"text\"\r\n                v-model=\"musteri_model.unvan\"\r\n                rows=\"5\"\r\n                cols=\"30\"\r\n                :class=\"{\r\n                  'p-invalid': v$.musteri_model.unvan.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"firmaAdi\">Firma Adı</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column\">\r\n            <div class=\"column\">\r\n              <span class=\"p-float-label\">\r\n                <InputText\r\n                  id=\"mail\"\r\n                  type=\"text\"\r\n                  v-model=\"musteri_model.mail_adresi\"\r\n                  :class=\"{\r\n                    'p-invalid':\r\n                      v$.musteri_model.mail_adresi.$invalid && submitted,\r\n                  }\"\r\n                />\r\n                <label for=\"mail\">MAİL</label>\r\n              </span>\r\n              <br />\r\n              <span class=\"p-float-label\">\r\n                <InputText id=\"sira\" type=\"text\" v-model=\"musteri_model.sira\" />\r\n                <label for=\"sira\">SIRA</label>\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column\">\r\n            <span class=\"p-float-label\">\r\n              <Textarea\r\n                id=\"sira\"\r\n                v-model=\"musteri_model.adres\"\r\n                rows=\"5\"\r\n                cols=\"100\"\r\n                :class=\"{\r\n                  'p-invalid': v$.musteri_model.adres.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"sira\">ADRES</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column is-3\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"marketing\"\r\n                type=\"text\"\r\n                v-model=\"musteri_model.marketing\"\r\n                :class=\"{\r\n                  'p-invalid': v$.musteri_model.marketing.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"marketing\">Pazarlama</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-3\" style=\"margin-left:30px;\">\r\n            <span class=\"p-float-label\">\r\n              <AutoComplete\r\n                id=\"ulke\"\r\n                v-model=\"select_ulke\"\r\n                :suggestions=\"filter_ulke_list\"\r\n                @complete=\"ulke_complete_event($event)\"\r\n                field=\"ulke_adi\"\r\n                :class=\"{ 'p-invalid': v$.select_ulke.$invalid && submitted }\"\r\n              />\r\n              <label for=\"ulke\">Ülke</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column is-3\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"telefon\"\r\n                type=\"text\"\r\n                v-model=\"musteri_model.telefon\"\r\n                :class=\"{\r\n                  'p-invalid': v$.musteri_model.telefon.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"telefon\">TELEFON</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-3\">\r\n            <span class=\"p-float-label\">\r\n              <AutoComplete\r\n                id=\"temsilci\"\r\n                v-model=\"select_temsilci\"\r\n                :suggestions=\"filter_temsilci_list\"\r\n                @complete=\"temsilci_complete_event($event)\"\r\n                field=\"kullanici_adi\"\r\n                :class=\"{\r\n                  'p-invalid': v$.select_temsilci.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"temsilci\">Temsilci</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column is-3\">\r\n            <span class=\"p-float-label\">\r\n              <AutoComplete\r\n                id=\"satisci\"\r\n                v-model=\"select_satisci\"\r\n                :suggestions=\"filter_satisci_list\"\r\n                @complete=\"satisci_complete_event($event)\"\r\n                field=\"kullanici_adi\"\r\n                :class=\"{\r\n                  'p-invalid': v$.select_satisci.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"satisci\">Satışçı</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-3\">\r\n            <span class=\"p-float-label\">\r\n              <Dropdown\r\n                id=\"oncelik\"\r\n                style=\"width: 100px\"\r\n                v-model=\"selectOncelik\"\r\n                :options=\"oncelikList\"\r\n                optionLabel=\"name\"\r\n                :class=\"{\r\n                  'p-invalid': v$.selectOncelik.$invalid && submitted,\r\n                }\"\r\n              />\r\n              <label for=\"oncelik\">Öncelik</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div class=\"columns\">\r\n          <div class=\"column is-6\">\r\n            <span class=\"p-float-label\">\r\n              <Textarea\r\n                id=\"notlar\"\r\n                v-model=\"musteri_model.notlar\"\r\n                rows=\"5\"\r\n                cols=\"30\"\r\n              />\r\n              <label for=\"notlar\">Notlar</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-4\">\r\n            <div class=\"columns\">\r\n              <div class=\"column is-2\">\r\n                <Checkbox v-model=\"musteri_model.devir\" :binary=\"true\" /> Devir\r\n              </div>\r\n              <div class=\"column is-2\">\r\n                <Checkbox v-model=\"musteri_model.ozel\" :binary=\"true\" />\r\n                Özel\r\n              </div>\r\n              <div class=\"column is-2\">\r\n                <Checkbox\r\n                  id=\"takip\"\r\n                  v-model=\"musteri_model.takip\"\r\n                  @change=\"isFollowChange\"\r\n                  :binary=\"true\"\r\n                />\r\n                <label for=\"takip\">Takip</label>\r\n              </div>\r\n              <div class=\"column is-2\">\r\n                <h3>Son Kullanıcı</h3>\r\n                <InputSwitch\r\n                  id=\"sonkullanici\"\r\n                  v-model=\"musteri_model.sonkullanici\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"column is-3\" style=\"margin-left: 40px\">\r\n        <DataTable\r\n          :value=\"siparis_ozet_list\"\r\n          :scrollable=\"true\"\r\n          scrollHeight=\"390px\"\r\n          selectionMode=\"single\"\r\n          dataKey=\"Yil\"\r\n          v-model:selection=\"selectYil\"\r\n          @row-select=\"YilUrunSecim($event)\"\r\n        >\r\n          <Column\r\n            field=\"Yil\"\r\n            header=\"Yıl\"\r\n            headerStyle=\"width:3%;\"\r\n            bodyStyle=\"text-align:left\"\r\n          >\r\n            <template #body=\"slotProps\">\r\n              {{ slotProps.data.Yil }}\r\n            </template>\r\n          </Column>\r\n          <Column\r\n            field=\"Total\"\r\n            header=\"DDP\"\r\n            headerStyle=\"width:3%;\"\r\n            bodyStyle=\"text-align:left\"\r\n          >\r\n            <template #body=\"slotProps\">\r\n              {{ formatPrice(slotProps.data.Total) }}\r\n            </template>\r\n          </Column>\r\n        </DataTable>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"columns is-multiline is-centered\">\r\n      <div class=\"column is-1\">\r\n        <Button\r\n          :disabled=\"is_kaydet\"\r\n          @click=\"musteri_kaydet_click\"\r\n          expanded\r\n          type=\"is-success\"\r\n          >KAYDET\r\n        </Button>\r\n      </div>\r\n      <div class=\"column is-1\">\r\n        <Button\r\n          :disabled=\"is_sil\"\r\n          @click=\"musteri_sil_click\"\r\n          expanded\r\n          class=\"p-button-danger\"\r\n          >SİL</Button\r\n        >\r\n      </div>\r\n    </div>\r\n    <Dialog\r\n      v-model:visible=\"is_form\"\r\n      :modal=\"true\"\r\n      header=\"Musteri Sipariş Detay\"\r\n      maximizable\r\n    >\r\n      <section>\r\n        <div class=\"container\">\r\n          <div class=\"columns\">\r\n            <div class=\"column is-12\">\r\n              <MusteriSiparisDetay />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </Dialog>\r\n  </section>\r\n</template>\r\n<script>\r\nimport { mapGetters } from \"vuex\";\r\nimport service from \"@/service/MusteriIslemService\";\r\nimport socket from \"@/service/SocketService\";\r\nimport MusteriSiparisDetay from \"./MusteriSiparisDetay\";\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport { required } from \"@vuelidate/validators\";\r\nexport default {\r\n  setup: () => ({ v$: useVuelidate() }),\r\n  validations() {\r\n    return {\r\n      select_ulke: { required },\r\n      select_temsilci: { required },\r\n      select_satisci: { required },\r\n      selectOncelik: { required },\r\n\r\n      musteri_model: {\r\n        musteri_adi: { required },\r\n        unvan: { required },\r\n        mail_adresi: { required },\r\n        sira: { required },\r\n        adres: { required },\r\n        marketing: { required },\r\n        telefon: { required },\r\n      },\r\n    };\r\n  },\r\n  data() {\r\n    return {\r\n      submitted: false,\r\n      select_ulke: null,\r\n      is_form: false,\r\n      filter_ulke_list: null,\r\n      select_temsilci: null,\r\n      select_satisci: null,\r\n      filter_temsilci_list: null,\r\n      filter_satisci_list: null,\r\n      is_kaydet: false,\r\n      selectYil: null,\r\n      siparis_ozet_list: null,\r\n      selectOncelik: null,\r\n      is_sil: true,\r\n      oncelikList: [\r\n        { id: 1, name: \"A\" },\r\n        { id: 2, name: \"B\" },\r\n        { id: 3, name: \"C\" },\r\n      ],\r\n    };\r\n  },\r\n  components: {\r\n    MusteriSiparisDetay,\r\n  },\r\n  created() {\r\n    if (!this.is_yeni) {\r\n      this.select_ulke = this.musteri_ulke_list.find(\r\n        (x) => x.id == this.musteri_model.ulke_id\r\n      );\r\n      this.select_temsilci = this.musteri_temsilci_list.find(\r\n        (x) => x.id == this.musteri_model.musteri_temsilci_id\r\n      );\r\n      this.select_satisci = this.musteri_temsilci_list.find(\r\n        (x) => x.id == this.musteri_model.satisci\r\n      ).kullanici_adi;\r\n      this.siparis_ozet_list = this.siparis_ozet;\r\n      this.selectOncelik = this.oncelikList.find(\r\n        (x) => x.name == this.musteri_model.selectOncelik\r\n      );\r\n      this.is_sil = false;\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters([\r\n      \"musteri_model\",\r\n      \"siparis_ozet\",\r\n      \"siparis_ozet_ayrinti\",\r\n      \"musteri_ulke_list\",\r\n      \"musteri_temsilci_list\",\r\n    ]),\r\n  },\r\n  props: [\"is_yeni\"],\r\n  methods: {\r\n    isFollowChange() {\r\n      service\r\n        .setCustomerChangeFollow(\r\n          this.musteri_model.musteri_adi,\r\n          this.musteri_model.takip\r\n        )\r\n        .then((data) => {\r\n          if (data) {\r\n            this.$toast.add({\r\n              severity: \"success\",\r\n              summary: \"Takip\",\r\n              detail: \"Takip Başarıyla Değişti\",\r\n              life: 3000,\r\n            });\r\n            this.emitter.emit(\"followingStatus\", false);\r\n          } else {\r\n            this.$toast.add({\r\n              severity: \"warning\",\r\n              summary: \"Takip\",\r\n              detail: \"Takip Değiştirme Hatalı\",\r\n              life: 3000,\r\n            });\r\n          }\r\n        });\r\n    },\r\n    YilUrunSecim(event) {\r\n      if (event.data) {\r\n        this.selectYil = event.data;\r\n        service\r\n          .getMusteriSiparisDetay(event.data.Yil, event.data.id)\r\n          .then((data) => {\r\n            this.$store.dispatch(\r\n              \"siparis_ozet_ayrinti_act\",\r\n              data.siparis_detay\r\n            );\r\n\r\n            this.is_form = true;\r\n          });\r\n      }\r\n    },\r\n    formatPrice(value) {\r\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\r\n      return \"$\" + val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\r\n    },\r\n    ulke_complete_event(event) {\r\n      this.filter_ulke_list = this.musteri_ulke_list.filter((x) => {\r\n        return (\r\n          x.ulke_adi\r\n            .toString()\r\n            .toLowerCase()\r\n            .indexOf(event.query.toString().toLowerCase()) >= 0\r\n        );\r\n      });\r\n    },\r\n    temsilci_complete_event(event) {\r\n      this.filter_temsilci_list = this.musteri_temsilci_list.filter((x) => {\r\n        return (\r\n          x.kullanici_adi\r\n            .toString()\r\n            .toLowerCase()\r\n            .indexOf(event.query.toString().toLowerCase()) >= 0\r\n        );\r\n      });\r\n    },\r\n    satisci_complete_event(event) {\r\n      this.filter_satisci_list = this.musteri_temsilci_list.filter((x) => {\r\n        return (\r\n          x.kullanici_adi\r\n            .toString()\r\n            .toLowerCase()\r\n            .indexOf(event.query.toString().toLowerCase()) >= 0\r\n        );\r\n      });\r\n      this.musteri_model.satisci = this.filter_satisci_list[0].id;\r\n    },\r\n    musteri_kaydet_click() {\r\n      this.submitted = true;\r\n      if (this.v$.$invalid) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Zorunlu Alanlar\",\r\n          detail: \"Zorunlu alanları doldurunuz!\",\r\n          life: 3000,\r\n        });\r\n      } else {\r\n        if (this.musteri_model.musteri_adi.length <= 0) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Müşteri Kaydet\",\r\n            detail: \"Müşteri Adı Giriniz..\",\r\n            life: 3000,\r\n          });\r\n          return;\r\n        }\r\n        if (this.musteri_model.marketing.length <= 0) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Müşteri Kaydet\",\r\n            detail: \"Marketing Giriniz..\",\r\n            life: 3000,\r\n          });\r\n          return;\r\n        }\r\n        if (this.select_ulke == null) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Müşteri Kaydet\",\r\n            detail: \"Ülke Giriniz..\",\r\n            life: 3000,\r\n          });\r\n          return;\r\n        }\r\n        if (this.select_temsilci == null) {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Müşteri Kaydet\",\r\n            detail: \"Temsilci Seçiniz..\",\r\n            life: 3000,\r\n          });\r\n          return;\r\n        }\r\n\r\n        this.musteri_model.musteri_temsilci_id = this.select_temsilci.id;\r\n\r\n        this.musteri_model.ulke_id = this.select_ulke.id;\r\n        let kullaniciadi = JSON.parse(\r\n          localStorage.getItem(\"user\")\r\n        ).kullaniciAdi;\r\n        this.musteri_model.kullanici_id = this.musteri_temsilci_list.find(\r\n          (x) => x.kullanici_adi === kullaniciadi\r\n        ).id;\r\n        this.musteri_model.selectOncelik = this.selectOncelik.name;\r\n        if (this.is_yeni) this.musteri_kayit_islemi();\r\n        else this.musteri_gunceleme_islemi();\r\n      }\r\n    },\r\n    musteri_gunceleme_islemi() {\r\n      if (this.musteri_model.id == null) {\r\n        alert(\"kayıt değiştirilemez.\");\r\n        return;\r\n      }\r\n\r\n      this.is_kaydet = true;\r\n      service.musteriGuncelle(this.musteri_model).then((response) => {\r\n        if (response.status) {\r\n          this.$toast.add({\r\n            severity: \"success\",\r\n            summary: \"Müşteri Güncelleme\",\r\n            detail: \"Müşteri Başarıyla Güncellendi\",\r\n            life: 3000,\r\n          });\r\n\r\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\r\n        } else {\r\n          this.$toast.add({\r\n            severity: \"error\",\r\n            summary: \"Müşteri Güncelleme\",\r\n            detail: \"Müşteri Başarısız\",\r\n            life: 3000,\r\n          });\r\n\r\n          this.is_kaydet = false;\r\n        }\r\n      });\r\n    },\r\n    musteri_kayit_islemi() {\r\n      const data = { ...this.musteri_model };\r\n      this.is_kaydet = true;\r\n      service.musteriKaydet(data).then((response) => {\r\n        if (response.status) {\r\n          alert(\"Musteri kaydı yapıldı.\");\r\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\r\n        } else {\r\n          alert(\"Müşteri kaydı yapılamadı kontrol ediniz.\");\r\n          this.is_kaydet = false;\r\n        }\r\n      });\r\n    },\r\n    musteri_sil_click() {\r\n      this.is_sil = true;\r\n      service.musteriSilme(this.musteri_model.id).then((response) => {\r\n        if (response.status) {\r\n          alert(\"Müşteri Kaydı Silindi.\");\r\n          socket.siparis.emit(\"musteri_kayitdegisim_event\");\r\n        } else {\r\n          alert(\"Müşteri kaydı silinemedi kontrol ediniz.\");\r\n          this.is_sil = false;\r\n        }\r\n      });\r\n    },\r\n  },\r\n};\r\n</script>\r\n"]},"metadata":{},"sourceType":"module"}