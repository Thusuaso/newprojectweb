{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport service from \"@/service/SevkiyatService\";\nimport socket from \"@/service/SocketService\";\nimport LocalService from \"@/service/LocalService\";\nimport store from \"@/store\";\nimport { useVuelidate } from \"@vuelidate/core\";\nimport { required } from \"@vuelidate/validators\";\nexport default {\n  setup() {\n    return {\n      v$: useVuelidate()\n    };\n  },\n  validations() {\n    return {\n      siparis: {\n        required\n      },\n      cikis_tarihi: {\n        required\n      },\n      faturano: {\n        required\n      }\n    };\n  },\n  data() {\n    return {\n      submitted: false,\n      filterSiparisListe: null,\n      selectedSipKalem: null,\n      is_navlun_form: false,\n      isNavlun: false,\n      isMobile: null,\n      is_kasa_form: true,\n      is_all_form: true,\n      siparis: \"\",\n      siparisList: null,\n      sipariskalemlist: null,\n      cikis_tarihi: null,\n      eta_tarihi: null,\n      sevk_toplam_satis: 0,\n      sevk_toplam_miktar: 0,\n      sevkmodel: null,\n      kasamodel: null,\n      siparis_miktar: 0,\n      giden: 0,\n      kalan: 0,\n      sipariskalem_kasalistesi: null,\n      kasalistesi: null,\n      toplam_uretim_adet: 0,\n      toplam_uretim_miktar: 0,\n      dis_kasa_sec: true,\n      sevk_kasa_listesi: [],\n      select_urunkartid: null,\n      musteri_id: null,\n      takip: true,\n      faturano: \"\",\n      normal_sevk: true,\n      hizli_sevk: false,\n      teslimturu: \"\",\n      navlunSatis: 0,\n      isSelectedHepsi: \"\",\n      user: \"\",\n      gidenMiktar: 0,\n      tedarikci_id: \"\"\n    };\n  },\n  localService: null,\n  beforeRouteEnter(to, from, next) {\n    store.dispatch(\"loadingBeginAct\");\n    service.getSiparisListe().then(data => {\n      next(vm => {\n        vm.siparisList = data;\n        store.dispatch(\"loadingEndAct\");\n\n        // console.log(\"vm.siparisList\",vm.siparisList)\n      });\n    });\n  },\n\n  created() {\n    this.localService = new LocalService();\n    this.user = this.$store.getters.__getUsername;\n    this.isMobile = window.innerWidth;\n  },\n  computed: {},\n  methods: {\n    filterSiparisList(event) {\n      let result;\n      if (event.query.length == 0) result = this.siparisList;else {\n        result = this.siparisList.filter(x => {\n          return x.siparisno.toLowerCase().startsWith(event.query);\n        });\n      }\n      this.filterSiparisListe = result;\n    },\n    formatDecimal(value) {\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\n      return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\n    },\n    siparisDegisim() {\n      if (this.siparis) {\n        setTimeout(() => {\n          service.getSiparisKalemList(this.siparis.siparisno).then(data => {\n            this.sipariskalemlist = data.siparis_kalem_list;\n            this.sipariskalem_kasalistesi = data.siparis_kalem_kasa_list;\n            const siparis_item = this.siparisList.filter(x => x.siparisno == this.siparis.siparisno);\n            this.musteri_id = siparis_item[0].musteriid;\n            this.teslimturu = this.sipariskalemlist[0].teslimturu;\n            this.navlunSatis = this.sipariskalemlist[0].navlunsatis;\n          });\n        }, 1300);\n      }\n    },\n    siparisKalemDegisim(event) {\n      let sipariskalem = this.sipariskalemlist.filter(x => x.id == event.value.id);\n      this.select_urunkartid = sipariskalem[0].urunkartid;\n      this.tedarikci_id = sipariskalem[0].tedarikciid;\n      this.siparis_miktar = sipariskalem[0].siparis;\n      this.kalan = this.siparis_miktar.toFixed(2) - this.giden.toFixed(2);\n      this.kasa_secim = true;\n      this.kasalistesi = this.sipariskalem_kasalistesi.filter(x => x.id == this.select_urunkartid && x.kasa_secim == false && sipariskalem[0].tedarikciid == x.tedarikci_id);\n      if (this.kasalistesi) this.kasa_secim = false;\n      this.uretimToplamGuncelle();\n      this.is_all_form = false;\n    },\n    uretimToplamGuncelle() {\n      if (this.kasalistesi) {\n        this.toplam_uretim_adet = this.kasalistesi.length;\n        this.giden = 0;\n        this.toplam_uretim_miktar = 0;\n        for (let key in this.kasalistesi) {\n          this.toplam_uretim_miktar += this.kasalistesi[key].miktar;\n          this.giden += this.kasalistesi[key].miktar;\n        }\n        this.gidenMiktar = this.giden.toFixed(2);\n        this.kalan = this.siparis_miktar.toFixed(2) - this.gidenMiktar;\n        this.kalan = this.kalan.toFixed(2);\n      }\n    },\n    kasaHepsiSec(event) {\n      if (this.kasalistesi) {\n        for (let key in this.kasalistesi) {\n          this.kasalistesi[key].kasa_secim = event;\n        }\n      }\n      this.is_all_form = true;\n      this.is_kasa_form = false;\n    },\n    kasaCikisYap() {\n      if (!this.kasalistesi) {\n        alert(\"Kasa Seçimi Yapınız..\");\n        return;\n      } else {\n        if (this.kasalistesi.filter(x => x.kasa_secim == true).length <= 0) {\n          alert(\"Kasa Seçimi Yapınız..\");\n          return;\n        }\n        for (let key in this.kasalistesi) {\n          const item = this.kasalistesi[key];\n          if (item.kasa_secim) {\n            this.sevkKasaYukle(item);\n            this.sipariskalem_kasalistesi.filter(x => x.kasano == item.kasano).kasa_secim = true;\n          }\n        }\n        this.sevk_toplam_miktar = 0;\n        this.sevk_toplam_satis = 0;\n        for (let key in this.sevk_kasa_listesi) {\n          const item = this.sevk_kasa_listesi[key];\n          this.sevk_toplam_satis += item.toplam;\n          this.sevk_toplam_miktar += item.miktar;\n        }\n        this.kasalistesi = this.sipariskalem_kasalistesi.filter(x => x.id == this.select_urunkartid && x.kasa_secim == false);\n      }\n      this.isSelectedHepsi = false;\n      this.toplam_uretim_adet = 0;\n      this.toplam_uretim_miktar = 0;\n      this.sipariskalemlist = this.sipariskalemlist.filter(x => x.urunkartid !== this.select_urunkartid || x.tedarikciid !== this.tedarikci_id);\n      this.is_kasa_form = true;\n    },\n    sevkKasaYukle(item) {\n      let kontrol = this.sevk_kasa_listesi.filter(x => x.kasano == item.kasano);\n      if (kontrol.length == 0) {\n        item.toplam = item.birimfiyat * item.miktar;\n        this.sevk_kasa_listesi.push(item);\n        console.log(\"sevk_kasa_listesi\", this.sevk_kasa_listesi);\n      }\n    },\n    sevkiyatIslemi() {\n      this.submitted = true;\n      if (this.v$.$invalid) {\n        this.$toast.add({\n          severity: \"error\",\n          summary: \"Zorunlu Alanlar\",\n          detail: \"Zorunlu alanları doldurunuz!\",\n          life: 3000\n        });\n      } else {\n        if (!this.cikis_tarihi) {\n          alert(\"Çıkış Tarihini Giriniz..\");\n          return;\n        }\n        if (this.faturano == \"\") {\n          alert(\"Fatura Nosunu Giriniz..\");\n          return;\n        }\n        if (this.sevk_kasa_listesi.length <= 0) {\n          alert(\"Kasa Listesi Boş Olamaz!\");\n          return;\n        }\n        if (this.navlunSatis <= 0 && this.teslimturu != \"EXW\" && this.teslimturu != \"FCA\" && this.teslimturu != \"FOB\") {\n          // this.is_navlun_form = false\n          if (confirm(\"Navlun Girilmemiş, Yinede Sevk Etmek İstermisiniz?\")) {\n            const sevk_data = {\n              siparisno: this.siparis.siparisno,\n              musteriid: this.musteri_id,\n              faturano: this.faturano,\n              takip: this.takip,\n              normal_sevk: this.normal_sevk,\n              hizli_sevk: this.hizli_sevk,\n              hatirlatma_sure: this.normal_sevk ? 5 : 3,\n              sevk_tarihi: this.localService.getDateString(this.cikis_tarihi),\n              kasalistesi: this.sevk_kasa_listesi,\n              sevkEden: this.user\n            };\n            service.siparisKayitIslem(sevk_data).then(data => {\n              if (data.status) {\n                alert(\"Kayıt İşlemi Yapıldı.\");\n                socket.siparis.emit(\"anaSayfaDegisiklikEvent\", data.anaSayfaDegisiklikList);\n                this.siparis = \"\";\n                this.sipariskalemlist = null;\n                this.kasalistesi = null;\n                this.sevk_kasa_listesi = null;\n                this.toplam_uretim_adet = 0;\n                this.toplam_uretim_miktar = 0;\n                this.sevk_toplam_satis = 0;\n                this.sevk_toplam_miktar = 0;\n                this.musteri_id = null;\n                this.faturano = \"\";\n                this.takip = false;\n                this.normal_sevk = true;\n                this.hizli_sevk = false;\n                this.cikis_tarihi = new Date();\n                this.giden = 0;\n                this.siparis_miktar = 0;\n                this.kalan = 0;\n              }\n            });\n          }\n        } else {\n          const sevk_data = {\n            siparisno: this.siparis.siparisno,\n            musteriid: this.musteri_id,\n            faturano: this.faturano,\n            takip: this.takip,\n            normal_sevk: this.normal_sevk,\n            hizli_sevk: this.hizli_sevk,\n            hatirlatma_sure: this.normal_sevk ? 5 : 3,\n            sevk_tarihi: this.localService.getDateString(this.cikis_tarihi),\n            kasalistesi: this.sevk_kasa_listesi,\n            sevkEden: this.user\n          };\n          service.siparisKayitIslem(sevk_data).then(data => {\n            if (data.status) {\n              alert(\"Kayıt İşlemi Yapıldı.\");\n              socket.siparis.emit(\"anaSayfaDegisiklikEvent\", data.anaSayfaDegisiklikList);\n              this.siparis = \"\";\n              this.sipariskalemlist = null;\n              this.kasalistesi = null;\n              this.sevk_kasa_listesi = null;\n              this.toplam_uretim_adet = 0;\n              this.toplam_uretim_miktar = 0;\n              this.sevk_toplam_satis = 0;\n              this.sevk_toplam_miktar = 0;\n              this.musteri_id = null;\n              this.faturano = \"\";\n              this.takip = false;\n              this.normal_sevk = true;\n              this.hizli_sevk = false;\n              this.cikis_tarihi = new Date();\n              this.giden = 0;\n              this.siparis_miktar = 0;\n              this.kalan = 0;\n            }\n          });\n        }\n      }\n    }\n  },\n  normalSevkIslem(event) {\n    if (event) this.hizli_sevk = false;\n  },\n  hizliSevkIslem(event) {\n    if (event) this.normal_sevk = false;\n  }\n};","map":{"version":3,"mappings":"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","names":["service","socket","LocalService","store","useVuelidate","required","setup","v$","validations","siparis","cikis_tarihi","faturano","data","submitted","filterSiparisListe","selectedSipKalem","is_navlun_form","isNavlun","isMobile","is_kasa_form","is_all_form","siparisList","sipariskalemlist","eta_tarihi","sevk_toplam_satis","sevk_toplam_miktar","sevkmodel","kasamodel","siparis_miktar","giden","kalan","sipariskalem_kasalistesi","kasalistesi","toplam_uretim_adet","toplam_uretim_miktar","dis_kasa_sec","sevk_kasa_listesi","select_urunkartid","musteri_id","takip","normal_sevk","hizli_sevk","teslimturu","navlunSatis","isSelectedHepsi","user","gidenMiktar","tedarikci_id","localService","beforeRouteEnter","to","from","next","dispatch","getSiparisListe","then","vm","created","$store","getters","__getUsername","window","innerWidth","computed","methods","filterSiparisList","event","result","query","length","filter","x","siparisno","toLowerCase","startsWith","formatDecimal","value","val","toFixed","replace","toString","siparisDegisim","setTimeout","getSiparisKalemList","siparis_kalem_list","siparis_kalem_kasa_list","siparis_item","musteriid","navlunsatis","siparisKalemDegisim","sipariskalem","id","urunkartid","tedarikciid","kasa_secim","uretimToplamGuncelle","key","miktar","kasaHepsiSec","kasaCikisYap","alert","item","sevkKasaYukle","kasano","toplam","kontrol","birimfiyat","push","console","log","sevkiyatIslemi","$invalid","$toast","add","severity","summary","detail","life","confirm","sevk_data","hatirlatma_sure","sevk_tarihi","getDateString","sevkEden","siparisKayitIslem","status","emit","anaSayfaDegisiklikList","Date","normalSevkIslem","hizliSevkIslem"],"sourceRoot":"","sources":["C:\\PROJELER\\NewProjects\\gitPull\\newprojectweb\\src\\views\\Sevkiyat.vue"],"sourcesContent":["<template>\r\n  <section>\r\n    <div class=\"columns is-multiline is-centered\">\r\n      <div class=\"column is-10\">\r\n        <div class=\"columns is-multiline\" style=\"margin-left: -129px\">\r\n          <div class=\"column is-4\">\r\n            <span class=\"p-float-label\">\r\n              <AutoComplete\r\n                id=\"siparisno\"\r\n                v-model=\"siparis\"\r\n                :suggestions=\"filterSiparisListe\"\r\n                @item-select=\"siparisDegisim\"\r\n                @complete=\"filterSiparisList($event)\"\r\n                optionLabel=\"siparisno\"\r\n                :class=\"{ 'p-invalid': v$.siparis.$invalid && submitted }\"\r\n              />\r\n\r\n              <label for=\"siparisno\">Sipariş Listesi</label>\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"columns is-multiline\">\r\n      <div class=\"column is-12 box\">\r\n        <h4 class=\"subtitle\">Çıkış Bilgileri</h4>\r\n\r\n        <div class=\"columns is-multiline\">\r\n          <div class=\"column is-2\">\r\n            <Calendar\r\n              v-model=\"cikis_tarihi\"\r\n              :class=\"{ 'p-invalid': v$.cikis_tarihi.$invalid && submitted }\"\r\n            />\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"faturano\"\r\n                type=\"text\"\r\n                v-model=\"faturano\"\r\n                :class=\"{ 'p-invalid': v$.faturano.$invalid && submitted }\"\r\n              />\r\n\r\n              <label for=\"faturano\">Fatura No</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <Checkbox v-model=\"takip\" :binary=\"true\" />Takip\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <Checkbox\r\n              @input=\"normalSevkIslem($event)\"\r\n              v-model=\"normal_sevk\"\r\n              :binary=\"true\"\r\n            />Normal Sevk\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <Checkbox\r\n              @input=\"hizliSevkIslem($event)\"\r\n              v-model=\"hizli_sevk\"\r\n              :binary=\"true\"\r\n            />Hızlı Sevk\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <br />\r\n    </div>\r\n    <div class=\"columns is-multiline\">\r\n      <div class=\"column is-12 box\">\r\n        <div class=\"columns is-multiline\">\r\n          <div class=\"column is-4\">\r\n            <span class=\"p-float-label\">\r\n              <Dropdown\r\n                id=\"icerik\"\r\n                @change=\"siparisKalemDegisim($event)\"\r\n                v-model=\"selectedSipKalem\"\r\n                :options=\"sipariskalemlist\"\r\n                optionLabel=\"icerik\"\r\n                :style=\"{ width: '350px' }\"\r\n              />\r\n\r\n              <label for=\"icerik\">Sipariş Kalem Listesi</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"siparis\"\r\n                type=\"text\"\r\n                v-model=\"siparis_miktar\"\r\n                disabled\r\n              />\r\n\r\n              <label for=\"siparis\">Sipariş</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <span class=\"p-float-label\">\r\n              <InputText\r\n                id=\"giden\"\r\n                type=\"text\"\r\n                v-model=\"gidenMiktar\"\r\n                disabled\r\n              />\r\n\r\n              <label for=\"giden\">Giden</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-2\" style=\"text-align: center\">\r\n            <span class=\"p-float-label\">\r\n              <InputText id=\"kalan\" type=\"text\" v-model=\"kalan\" disabled />\r\n              <label for=\"kalan\">Kalan</label>\r\n            </span>\r\n          </div>\r\n          <div class=\"column is-2\">\r\n            <Button type=\"is-success\" @click=\"sevkiyatIslemi\" label=\"Sevk Et\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"columns is-multiline\">\r\n      <div class=\"column is-4\">\r\n        <div class=\"columns is-multiline\">\r\n          <div class=\"column is-12\">\r\n            <h2 class=\"has-text-centered\">ÜRETİM ÜRÜN LİSTESİ</h2>\r\n          </div>\r\n          <div class=\"column is-12\">\r\n            <DataTable :value=\"kasalistesi\" dataKey=\"kasano\">\r\n              <Column field=\"kasano\" header=\"No\">\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.kasano }}\r\n                </template>\r\n                <template #footer>\r\n                  {{ toplam_uretim_adet }}\r\n                </template>\r\n              </Column>\r\n              <Column field=\"miktar\" header=\"Miktar\">\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.miktar }}\r\n                </template>\r\n                <template #footer>\r\n                  {{ formatDecimal(toplam_uretim_miktar) }}\r\n                </template>\r\n              </Column>\r\n              <Column field=\"birimadi\" header=\"B\">\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.birimadi }}\r\n                </template>\r\n              </Column>\r\n\r\n              <Column\r\n                field=\"kasa_secim\"\r\n                header=\"S\"\r\n                bodyStyle=\"text-align:center;\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  <Checkbox\r\n                    v-model=\"slotProps.data.kasa_secim\"\r\n                    :binary=\"true\"\r\n                  />\r\n                </template>\r\n              </Column>\r\n            </DataTable>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"column is-2\">\r\n        <div class=\"columns is-multiline\">\r\n          <div class=\"column is-12 btn_islem\">\r\n            <Button\r\n              class=\"p-button-secondary\"\r\n              @click=\"kasaCikisYap\"\r\n              :disabled=\"is_kasa_form\"\r\n              label=\"Kasa Çık\"\r\n            />\r\n          </div>\r\n          <div class=\"column is-12 is-justified\">\r\n            <Checkbox\r\n              @input=\"kasaHepsiSec($event)\"\r\n              v-model=\"isSelectedHepsi\"\r\n              :disabled=\"is_all_form\"\r\n              :binary=\"true\"\r\n            />\r\n            Hepsi\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"column is-6\">\r\n        <div class=\"columns is-multiline is-mobile\">\r\n          <div class=\"column is-12\">\r\n            <h2 class=\"has-text-centered\">ÇIKIŞ ÜRÜN LİSTESİ</h2>\r\n          </div>\r\n          <div class=\"column is-12\">\r\n            <DataTable :value=\"sevk_kasa_listesi\">\r\n              <Column\r\n                header=\"Kasa No\"\r\n                headerStyle=\"width:70px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.kasano }}\r\n                </template>\r\n              </Column>\r\n              <Column\r\n                header=\"Ürün\"\r\n                headerStyle=\"width:70px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.urunadi }}\r\n                </template>\r\n              </Column>\r\n              <Column\r\n                header=\"Ebat\"\r\n                headerStyle=\"width:70px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.ebat }}\r\n                </template>\r\n              </Column>\r\n              <Column header=\"Yüzey\" headerStyle=\"width:130px\">\r\n                <template #body=\"slotProps\">\r\n                  {{ slotProps.data.yuzeyislem }}\r\n                </template>\r\n              </Column>\r\n              <Column\r\n                field=\"miktar\"\r\n                header=\"Miktar\"\r\n                headerStyle=\"width:70px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ formatDecimal(slotProps.data.miktar) }}\r\n                </template>\r\n                <template #footer>\r\n                  {{ formatDecimal(sevk_toplam_miktar) }}\r\n                </template>\r\n              </Column>\r\n              <Column\r\n                field=\"birimfiyat\"\r\n                header=\"B\"\r\n                headerStyle=\"width:70px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ formatDecimal(slotProps.data.birimfiyat) }}\r\n                </template>\r\n              </Column>\r\n              <Column\r\n                header=\"Satış Toplam\"\r\n                headerStyle=\"width:90px\"\r\n                bodyStyle=\"text-align:center\"\r\n              >\r\n                <template #body=\"slotProps\">\r\n                  {{ formatDecimal(slotProps.data.toplam) }}\r\n                </template>\r\n                <template #footer>\r\n                  {{ formatDecimal(sevk_toplam_satis) }}\r\n                </template>\r\n              </Column>\r\n            </DataTable>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n<script>\r\nimport service from \"@/service/SevkiyatService\";\r\nimport socket from \"@/service/SocketService\";\r\nimport LocalService from \"@/service/LocalService\";\r\nimport store from \"@/store\";\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport { required } from \"@vuelidate/validators\";\r\nexport default {\r\n  setup() {\r\n    return { v$: useVuelidate() };\r\n  },\r\n  validations() {\r\n    return {\r\n      siparis: { required },\r\n      cikis_tarihi: { required },\r\n      faturano: { required },\r\n    };\r\n  },\r\n  data() {\r\n    return {\r\n      submitted: false,\r\n      filterSiparisListe: null,\r\n      selectedSipKalem: null,\r\n      is_navlun_form: false,\r\n      isNavlun: false,\r\n      isMobile: null,\r\n      is_kasa_form: true,\r\n      is_all_form: true,\r\n      siparis: \"\",\r\n      siparisList: null,\r\n      sipariskalemlist: null,\r\n      cikis_tarihi: null,\r\n      eta_tarihi: null,\r\n      sevk_toplam_satis: 0,\r\n      sevk_toplam_miktar: 0,\r\n      sevkmodel: null,\r\n      kasamodel: null,\r\n      siparis_miktar: 0,\r\n      giden: 0,\r\n      kalan: 0,\r\n      sipariskalem_kasalistesi: null,\r\n      kasalistesi: null,\r\n      toplam_uretim_adet: 0,\r\n      toplam_uretim_miktar: 0,\r\n      dis_kasa_sec: true,\r\n      sevk_kasa_listesi: [],\r\n      select_urunkartid: null,\r\n      musteri_id: null,\r\n      takip: true,\r\n      faturano: \"\",\r\n      normal_sevk: true,\r\n      hizli_sevk: false,\r\n      teslimturu: \"\",\r\n      navlunSatis: 0,\r\n      isSelectedHepsi: \"\",\r\n      user: \"\",\r\n      gidenMiktar: 0,\r\n      tedarikci_id: \"\",\r\n    };\r\n  },\r\n  localService: null,\r\n  beforeRouteEnter(to, from, next) {\r\n    store.dispatch(\"loadingBeginAct\");\r\n    service.getSiparisListe().then((data) => {\r\n      next((vm) => {\r\n        vm.siparisList = data;\r\n        store.dispatch(\"loadingEndAct\");\r\n\r\n        // console.log(\"vm.siparisList\",vm.siparisList)\r\n      });\r\n    });\r\n  },\r\n  created() {\r\n    this.localService = new LocalService();\r\n    this.user = this.$store.getters.__getUsername;\r\n    this.isMobile = window.innerWidth;\r\n  },\r\n  computed: {},\r\n  methods: {\r\n    filterSiparisList(event) {\r\n      let result;\r\n      if (event.query.length == 0) result = this.siparisList;\r\n      else {\r\n        result = this.siparisList.filter((x) => {\r\n          return x.siparisno.toLowerCase().startsWith(event.query);\r\n        });\r\n      }\r\n      this.filterSiparisListe = result;\r\n    },\r\n    formatDecimal(value) {\r\n      let val = (value / 1).toFixed(2).replace(\".\", \",\");\r\n      return val.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \".\");\r\n    },\r\n    siparisDegisim() {\r\n      if (this.siparis) {\r\n        setTimeout(() => {\r\n          service.getSiparisKalemList(this.siparis.siparisno).then((data) => {\r\n            this.sipariskalemlist = data.siparis_kalem_list;\r\n            this.sipariskalem_kasalistesi = data.siparis_kalem_kasa_list;\r\n            const siparis_item = this.siparisList.filter(\r\n              (x) => x.siparisno == this.siparis.siparisno\r\n            );\r\n\r\n            this.musteri_id = siparis_item[0].musteriid;\r\n            this.teslimturu = this.sipariskalemlist[0].teslimturu;\r\n            this.navlunSatis = this.sipariskalemlist[0].navlunsatis;\r\n          });\r\n        }, 1300);\r\n      }\r\n    },\r\n    siparisKalemDegisim(event) {\r\n      let sipariskalem = this.sipariskalemlist.filter(\r\n        (x) => x.id == event.value.id\r\n      );\r\n      this.select_urunkartid = sipariskalem[0].urunkartid;\r\n      this.tedarikci_id = sipariskalem[0].tedarikciid;\r\n      this.siparis_miktar = sipariskalem[0].siparis;\r\n\r\n      this.kalan = this.siparis_miktar.toFixed(2) - this.giden.toFixed(2);\r\n\r\n      this.kasa_secim = true;\r\n      this.kasalistesi = this.sipariskalem_kasalistesi.filter(\r\n        (x) =>\r\n          x.id == this.select_urunkartid &&\r\n          x.kasa_secim == false &&\r\n          sipariskalem[0].tedarikciid == x.tedarikci_id\r\n      );\r\n\r\n      if (this.kasalistesi) this.kasa_secim = false;\r\n      this.uretimToplamGuncelle();\r\n      this.is_all_form = false;\r\n    },\r\n\r\n    uretimToplamGuncelle() {\r\n      if (this.kasalistesi) {\r\n        this.toplam_uretim_adet = this.kasalistesi.length;\r\n        this.giden = 0;\r\n        this.toplam_uretim_miktar = 0;\r\n        for (let key in this.kasalistesi) {\r\n          this.toplam_uretim_miktar += this.kasalistesi[key].miktar;\r\n          this.giden += this.kasalistesi[key].miktar;\r\n        }\r\n        this.gidenMiktar = this.giden.toFixed(2);\r\n        this.kalan = this.siparis_miktar.toFixed(2) - this.gidenMiktar;\r\n        this.kalan = this.kalan.toFixed(2);\r\n      }\r\n    },\r\n    kasaHepsiSec(event) {\r\n      if (this.kasalistesi) {\r\n        for (let key in this.kasalistesi) {\r\n          this.kasalistesi[key].kasa_secim = event;\r\n        }\r\n      }\r\n      this.is_all_form = true;\r\n      this.is_kasa_form = false;\r\n    },\r\n    kasaCikisYap() {\r\n      if (!this.kasalistesi) {\r\n        alert(\"Kasa Seçimi Yapınız..\");\r\n        return;\r\n      } else {\r\n        if (this.kasalistesi.filter((x) => x.kasa_secim == true).length <= 0) {\r\n          alert(\"Kasa Seçimi Yapınız..\");\r\n          return;\r\n        }\r\n\r\n        for (let key in this.kasalistesi) {\r\n          const item = this.kasalistesi[key];\r\n\r\n          if (item.kasa_secim) {\r\n            this.sevkKasaYukle(item);\r\n            this.sipariskalem_kasalistesi.filter(\r\n              (x) => x.kasano == item.kasano\r\n            ).kasa_secim = true;\r\n          }\r\n        }\r\n        this.sevk_toplam_miktar = 0;\r\n        this.sevk_toplam_satis = 0;\r\n        for (let key in this.sevk_kasa_listesi) {\r\n          const item = this.sevk_kasa_listesi[key];\r\n\r\n          this.sevk_toplam_satis += item.toplam;\r\n          this.sevk_toplam_miktar += item.miktar;\r\n        }\r\n\r\n        this.kasalistesi = this.sipariskalem_kasalistesi.filter(\r\n          (x) => x.id == this.select_urunkartid && x.kasa_secim == false\r\n        );\r\n      }\r\n      this.isSelectedHepsi = false;\r\n      this.toplam_uretim_adet = 0;\r\n      this.toplam_uretim_miktar = 0;\r\n      this.sipariskalemlist = this.sipariskalemlist.filter(\r\n        (x) =>\r\n          x.urunkartid !== this.select_urunkartid ||\r\n          x.tedarikciid !== this.tedarikci_id\r\n      );\r\n      this.is_kasa_form = true;\r\n    },\r\n    sevkKasaYukle(item) {\r\n      let kontrol = this.sevk_kasa_listesi.filter(\r\n        (x) => x.kasano == item.kasano\r\n      );\r\n      if (kontrol.length == 0) {\r\n        item.toplam = item.birimfiyat * item.miktar;\r\n        this.sevk_kasa_listesi.push(item);\r\n        console.log(\"sevk_kasa_listesi\", this.sevk_kasa_listesi);\r\n      }\r\n    },\r\n    sevkiyatIslemi() {\r\n      this.submitted = true;\r\n      if (this.v$.$invalid) {\r\n        this.$toast.add({\r\n          severity: \"error\",\r\n          summary: \"Zorunlu Alanlar\",\r\n          detail: \"Zorunlu alanları doldurunuz!\",\r\n          life: 3000,\r\n        });\r\n      } else {\r\n        if (!this.cikis_tarihi) {\r\n          alert(\"Çıkış Tarihini Giriniz..\");\r\n          return;\r\n        }\r\n        if (this.faturano == \"\") {\r\n          alert(\"Fatura Nosunu Giriniz..\");\r\n          return;\r\n        }\r\n        if (this.sevk_kasa_listesi.length <= 0) {\r\n          alert(\"Kasa Listesi Boş Olamaz!\");\r\n          return;\r\n        }\r\n        if (\r\n          this.navlunSatis <= 0 &&\r\n          this.teslimturu != \"EXW\" &&\r\n          this.teslimturu != \"FCA\" &&\r\n          this.teslimturu != \"FOB\"\r\n        ) {\r\n          // this.is_navlun_form = false\r\n          if (confirm(\"Navlun Girilmemiş, Yinede Sevk Etmek İstermisiniz?\")) {\r\n            const sevk_data = {\r\n              siparisno: this.siparis.siparisno,\r\n              musteriid: this.musteri_id,\r\n              faturano: this.faturano,\r\n              takip: this.takip,\r\n              normal_sevk: this.normal_sevk,\r\n              hizli_sevk: this.hizli_sevk,\r\n              hatirlatma_sure: this.normal_sevk ? 5 : 3,\r\n              sevk_tarihi: this.localService.getDateString(this.cikis_tarihi),\r\n              kasalistesi: this.sevk_kasa_listesi,\r\n              sevkEden: this.user,\r\n            };\r\n\r\n            service.siparisKayitIslem(sevk_data).then((data) => {\r\n              if (data.status) {\r\n                alert(\"Kayıt İşlemi Yapıldı.\");\r\n                socket.siparis.emit(\r\n                  \"anaSayfaDegisiklikEvent\",\r\n                  data.anaSayfaDegisiklikList\r\n                );\r\n                this.siparis = \"\";\r\n                this.sipariskalemlist = null;\r\n                this.kasalistesi = null;\r\n                this.sevk_kasa_listesi = null;\r\n                this.toplam_uretim_adet = 0;\r\n                this.toplam_uretim_miktar = 0;\r\n                this.sevk_toplam_satis = 0;\r\n                this.sevk_toplam_miktar = 0;\r\n                this.musteri_id = null;\r\n                this.faturano = \"\";\r\n                this.takip = false;\r\n                this.normal_sevk = true;\r\n                this.hizli_sevk = false;\r\n                this.cikis_tarihi = new Date();\r\n                this.giden = 0;\r\n                this.siparis_miktar = 0;\r\n                this.kalan = 0;\r\n              }\r\n            });\r\n          }\r\n        } else {\r\n          const sevk_data = {\r\n            siparisno: this.siparis.siparisno,\r\n            musteriid: this.musteri_id,\r\n            faturano: this.faturano,\r\n            takip: this.takip,\r\n            normal_sevk: this.normal_sevk,\r\n            hizli_sevk: this.hizli_sevk,\r\n            hatirlatma_sure: this.normal_sevk ? 5 : 3,\r\n            sevk_tarihi: this.localService.getDateString(this.cikis_tarihi),\r\n            kasalistesi: this.sevk_kasa_listesi,\r\n            sevkEden: this.user,\r\n          };\r\n\r\n          service.siparisKayitIslem(sevk_data).then((data) => {\r\n            if (data.status) {\r\n              alert(\"Kayıt İşlemi Yapıldı.\");\r\n              socket.siparis.emit(\r\n                \"anaSayfaDegisiklikEvent\",\r\n                data.anaSayfaDegisiklikList\r\n              );\r\n              this.siparis = \"\";\r\n              this.sipariskalemlist = null;\r\n              this.kasalistesi = null;\r\n              this.sevk_kasa_listesi = null;\r\n              this.toplam_uretim_adet = 0;\r\n              this.toplam_uretim_miktar = 0;\r\n              this.sevk_toplam_satis = 0;\r\n              this.sevk_toplam_miktar = 0;\r\n              this.musteri_id = null;\r\n              this.faturano = \"\";\r\n              this.takip = false;\r\n              this.normal_sevk = true;\r\n              this.hizli_sevk = false;\r\n              this.cikis_tarihi = new Date();\r\n              this.giden = 0;\r\n              this.siparis_miktar = 0;\r\n              this.kalan = 0;\r\n            }\r\n          });\r\n        }\r\n      }\r\n    },\r\n  },\r\n  normalSevkIslem(event) {\r\n    if (event) this.hizli_sevk = false;\r\n  },\r\n  hizliSevkIslem(event) {\r\n    if (event) this.normal_sevk = false;\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.p-datatable {\r\n  font-size: 10px;\r\n}\r\n\r\n.btn_islem {\r\n  margin-top: 75px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}